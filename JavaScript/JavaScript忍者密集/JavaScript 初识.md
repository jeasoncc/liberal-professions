## 为什么 JavaScript 这门语言有些不一样

> 想要获得非凡的成功，必须要找到自己的战场
>
> 起点低，不要怕，持续的走下去，才是核心。

很多人都用过 JavaScript，然而很多人对这门语言的运用都处于相当初级的层次。由于 JavaScript 有着与类 C 语言相近的外表，从而给人留下了与这些语言相近的印象。

人们从觉得他们对其他编程语言的了解，能为他们理解 JavaScript 的工作原理打下坚实的基础。然而这是一个陷阱，与其他主流语言相比，JavaScript 函数式语言的血统更多一点。JavaScript 中的一些概念从根本上不同于其他的语言：

- 函数是一等公民——在 JavaScript 中，函数与其他对象共存，并且能够像任何其他语言一样地使用。函数可以通过字面量创建，可以赋值给变量，可以作为函数参数传递，甚至可以作为返回值从函数中返回。
- 函数闭包——大部分 JavaScript 基础程序员都对闭包缺乏理解，然而它却从根本上例证了函数之于 JavaScript 的重要性。尽管就目前而言，了解函数主动维护了函数内使用外部的变量，则函数为一个闭包就已经足够。
- 作用域——JavaScript没有块级作用域的变量，取而代之只有函数级别的作用域和全局作用域。
- 基于原型的面向对象——不同于其他语言的面向对象，JavaScript 不是使用基于类的面向对象，它使用基于原型的面向对象。

**对象、原型、函数和闭包的紧密组合组成了 JavaScript。理解这些概念的密切联系，能大大提高你的编程能力，为你开发各类应用提供坚固的基础。**

除了这些概念，JavaScript 的一些其他特性也能帮你书写优雅高效的代码。

- 生成器，一种可以基于一次请求多次值的函数，在不同请求之间也能挂起执行。
- Promise，让我们更好地控制异步代码。
- 代理，让我们控制特定对象的访问。
- 高级数组方法，书写更优雅的数组处理函数。
- Map，用于创建字典合集；Set，处理包含不重复项目的集合。
- 正则表达式，简化用代码书写起来很复杂的逻辑。
- 模块，把代码划分为较小的可以自含的片段，使项目更易于管理。

深入理解 JavaScript 的基础知识，以及学习如何最大程度利用 JavaScript 的高级特性，能够让你的代码编写水平提升到一个更高的水平。磨炼这些技能，并将这些概念和特性连贯起来也能让你对 JavaScript 的理解更上一层楼，从而为你编写各种类型的 JavaScript 应用赋予更强大的创造力。

## 理解浏览器

JavaScript 能在很多环境中执行，但是， JavaScript 最初的运行环境是浏览器环境，而其他的环境也是借鉴于浏览器的环境。

这是浏览器运行环境的一些核心概念：

- **文档对象模式（DOM**）—— DOM 是 Web 应用的结构化的 UI 表现形式，至少最初由 Web 应用的 HTML 代码构成。为开发大型应用，需要了解 JavaScript 的核心机制，还要学习 DOM 是如何构成的，以及如何书写有效的 DOM 操作代码。
- **事件**——大部分 JavaScript 应用都是事件驱动的应用，这表示大部分代码在某个特殊响应的上下文中。这样的事件例如网络事件、计时器、用户点击事件等。
- **浏览器 API**，帮助我们与世界交互，浏览器提供<u>获取设备的信息</u>、<u>存储本地数据</u>或<u>与远程浏览器交互</u>的 API。你将会遇到浏览器的不一致等问题。在完美的世界里，所有浏览器都应该没有缺陷，应该都能以一致的方式支持 Web 标准

如今的浏览器的质量已经大大提高了，但我们还需要面对一些缺陷：<u>例如缺失的 API，某个浏览器的奇怪问题</u>。**针对浏览器的这些问题，开发出一种易于理解的机制，并搞清楚它们的差异和宽松模式，这与精通 JavaScript 几乎同等重要。**

我们开发浏览器应用或 JavaScript 库时，选择支持哪些浏览器是很值得深思熟虑的。一般我们都希望全部支持，但往往都会受限于资源有限。

开发高效的跨浏览器代码，显著依赖于开发者的经验和技巧。

## 使用当前的最佳实践

详细了解 JavaScript 语言和掌握跨浏览器代码问题，对于专家级 Web 应用开发者来说是值得的，但它们不是整个蓝图。若想掌握整个蓝图，你还需要展示出一些已经被证明的高质量代码，这些特制被称为最佳实践，所以你除了熟悉 JavaScript 语言之外，还需要以下的特质：

- 调试技巧
- 测试
- 性能分析

### 调试

以前，调试 JavaScript 代码意味者使用 alert 或者 console 来验证变量的值。好在 Firefox 浏览器的开发者扩展 Firebug 的流行，所以调试 JavaScript 代码的能力大大增强了。所有的主流的调试工具也都被开发了出来。

- Firebug——开发者扩展工具 Firefox 的流行成为了调试工具的开端。
- Chrome DevTools——由 Chrome 团队开发，并应用在了 Chrome 和 Opera 浏览器中。
- WebKit 检视器——Safari 中包含的调试工具。

主流的浏览器都为开发者提供了调试 Web 应用程序的工具。使用 console 来调试 JavaScript 代码的时代一去不复返了！所有这些工具都有着类似 Firebug 最初引入的概念，故而它们都提供了相似的功能：

- 探索 DOM
- 调试 JavaScript
- 编辑 CSS 样式
- 跟踪网络事件等。

### 测试

我们需要使用一些测试技术来确保代码按预期执行，同时这些测试技术也用于展示一般情况如何测试代码。我<u>们用于测试主要工具，往往是一个**断言函数**，其目的在于断定某个假值是真值还是假值。</u>

该函数的一般形式：

```js
assert(conition,message)
```

第一个参数是一个应为真值的条件，第二个参数是当断言为假时所展示的一句话：

```js
assert(a === true, "A is not true!")
```

如果变量不为 true，那么断言失败，后面的提示就没出来。

### 性能分析

**分析性能是另一个重要实践，尽管 JavaScript 引擎已经让 JavaScript 以惊人的效率提升，然而我们依然没有理由编写粗糙低效的代码。**

```js
console.time('foo bar')

for(var a = 0; n < maxCount; n ++){
    // 操作
}

console.timeEnd('foo bar')
```

这段代码中，我们要把被测量的代码放在两个计时器之间，分别是内置 console 对象上的 time 和 timeEnd 方法。

在操作开始之前，调用 console.time 启动一个命名计时器。然后在特定的循环次数下运行代码。由于一次操作执行太快很难测量，所以我们要多次运行代码从而取得一个能够测量的值。**运行次数可以成百上千，甚至上万，其完全依赖于被测量的代码性质。几次摸索后我们就能得到一个合理的值。**

操作结束后则用相同的计时器调用 console.timeEnd。随后浏览器就会输出从开始到当前的时间差。

把这种技术所学到的最佳实践统一，你对 JavaScript 的开发能力就会大幅度提升。在浏览器提供的有限资源下，在浏览器能力和兼容性逐渐复杂的世界中开发应用，需要一套健壮和完整的技巧。

## 提供跨平台开发能力

浏览器之争以 HTML、CSS、DOM、API 和 JavaScript 的标准化而结束，从而开发者能集中精力开发高效的跨浏览器 JavaScript 应用。确实，集中精力把网站开发为应用催生了大量的想法、工具和从桌面应用到网站应用的技术。现如今，这些知识和工具的转换再次发生，想法、工具和源于客户端 Web 开发的技术逐渐渗入应用开发的其他领域。

**对 <u>JavaScript 基本原理</u>和<u>核心 API</u> 的渗入理解能让你成为更全能的开发者**。通过使用浏览器和 Node.js，你能够开发几乎你能够想到的任何类型的应用。

- 桌面应用。通过	NW.js 或 Electron 的库可以开发桌面应用。**这些技术通常通过包装浏览器使我们能用<u>标准的 HTML、CSS 和 JavaScript</u> 以及<u>一些额外的访问文件系统</u>的能力来构建桌面应用**。从而能够开发真正独立于平台的桌面应用，它和我们在 Window、 Mac 和 Linux 上见到的应用看起来一样。
- 移动应用，使用类似 Apache Cordova 的框架开发。与使用 Web 技术构建桌面应用一样，该应用框架也包括了浏览器，不过其中还包含一些额外的针对特定平台 API，从而让开发者能与移动平台交互。
- 使用 Node.js 开发服务器应用嵌入式应用，Node.js 是源自于浏览器的环境，使用了很多类似浏览器的底层原理。

只要理解了 JavaScript 工作的核心原理，理解了浏览器提供的核心 API，你就加速所有应用的开发。在这个过程中，你将变得更全能，知识和理解力也逐渐增长，从而能够处理各种各样的问题。你就能够在云上通过使用 JavaScript API 构建无需依赖服务器的应用。

## 小结

- 客户端 Web 应用作为如今最流行，其概念、工具和技术从仅开发客户端 Web 应用已经深入到其他应用领域。理解客户端 Web 应用的基础能帮你开发一系列不同领域的应用。
- 为了提高开发技能，你需要深入理解 JavaScript 的核心机制和浏览器所提供的架构。
- JavaScript 可以在大量的环境中执行，但所有环境的开端是我们将集中讨论的浏览器环境。
- 除了 JavaScript 以外，我们还将探索浏览器内部，例如 DOM 和事件，这是因为客户端 Web 应用是事件驱动的一种。



